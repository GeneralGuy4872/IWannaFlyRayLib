use strict;
use warnings;
use feature "switch";

open(my $file,'+>','./modules/IWannaFly/Paths.pm');

printf $file <<'ETX';
package IWannaFly::Paths;
require Exporter;
our @ISA = qw(Exporter);
our @EXPORT;
ETX
say $file '#AUTOGENERATED';

open(my $header,'<','./paths.h');

until (eof($header)) {
	if (<$header> =~ m/^#define ([\w]*) ([\S]*)(?:$|\t)/) {
		my $foo = $1;
		my $bar = $2;
		$bar =~ s/(?:(?<!\\)\")/\'/g;
		printf $file 'use constant ENV__';
		printf $file "$foo => $bar;\n";
		say $file 'push(@EXPORT,ENV__' . $foo . ');';
		}
	}
close $header;
close $file;
__END__
